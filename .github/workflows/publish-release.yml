name: Publish Draft Release

on:
  workflow_dispatch:
  push:
    tags:
      - 'v*'

env:
  dotnet-version: 6.0.x # SDK Version for building Dafny
  
jobs:
  check-deep-tests:
    uses: ./.github/workflows/check-deep-tests-reusable.yml
    with:
      sha: ${{ github.sha }}

  publish-release:
    uses: ./.github/workflows/publish-release-reusable.yml
    with:
      name: Dafny ${{ needs.get-version.outputs.version }}
      sha: ${{ github.sha }}
      tag_name: ${{ github.ref }}
      prerelease: false
      draft: true
      release_nuget: true
      # We can probably automate pulling this out of RELEASE_NOTES.md in the future
      release_notes: ""
